<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Data Science</title>
  <meta name="description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with dplyr, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with dplyr, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Data Science" />
  
  <meta name="twitter:description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with dplyr, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown." />
  

<meta name="author" content="Rafael A. Irizarry">


<meta name="date" content="2017-11-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-visualization-principles.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#case-studies"><i class="fa fa-check"></i><b>1.1</b> Case Studies</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-will-find-this-book-useful"><i class="fa fa-check"></i><b>1.2</b> Who Will Find This Book Useful?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-does-this-book-cover"><i class="fa fa-check"></i><b>1.3</b> What Does This Book Cover?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-is-not-covered-by-this-book"><i class="fa fa-check"></i><b>1.4</b> What is Not Covered by This Book?</a></li>
</ul></li>
<li class="part"><span><b>I R Basics</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="motivating-case-study.html"><a href="motivating-case-study.html"><i class="fa fa-check"></i><b>3</b> Motivating Case Study</a><ul>
<li class="chapter" data-level="3.1" data-path="motivating-case-study.html"><a href="motivating-case-study.html#why-r"><i class="fa fa-check"></i><b>3.1</b> Why R?</a></li>
<li class="chapter" data-level="3.2" data-path="motivating-case-study.html"><a href="motivating-case-study.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting Started</a><ul>
<li class="chapter" data-level="3.2.1" data-path="motivating-case-study.html"><a href="motivating-case-study.html#installing-r"><i class="fa fa-check"></i><b>3.2.1</b> Installing R</a></li>
<li class="chapter" data-level="3.2.2" data-path="motivating-case-study.html"><a href="motivating-case-study.html#the-r-console"><i class="fa fa-check"></i><b>3.2.2</b> The R console</a></li>
<li class="chapter" data-level="3.2.3" data-path="motivating-case-study.html"><a href="motivating-case-study.html#scripts"><i class="fa fa-check"></i><b>3.2.3</b> Scripts</a></li>
<li class="chapter" data-level="3.2.4" data-path="motivating-case-study.html"><a href="motivating-case-study.html#installing-rstudio"><i class="fa fa-check"></i><b>3.2.4</b> Installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="motivating-case-study.html"><a href="motivating-case-study.html#the-r-ecosystem"><i class="fa fa-check"></i><b>3.3</b> The R ecosystem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-very-basics.html"><a href="the-very-basics.html"><i class="fa fa-check"></i><b>4</b> The Very Basics</a><ul>
<li class="chapter" data-level="4.1" data-path="the-very-basics.html"><a href="the-very-basics.html#objects"><i class="fa fa-check"></i><b>4.1</b> Objects</a></li>
<li class="chapter" data-level="4.2" data-path="the-very-basics.html"><a href="the-very-basics.html#the-workspace"><i class="fa fa-check"></i><b>4.2</b> The Workspace</a></li>
<li class="chapter" data-level="4.3" data-path="the-very-basics.html"><a href="the-very-basics.html#functions"><i class="fa fa-check"></i><b>4.3</b> Functions</a></li>
<li class="chapter" data-level="4.4" data-path="the-very-basics.html"><a href="the-very-basics.html#other-prebuilt-objects"><i class="fa fa-check"></i><b>4.4</b> Other prebuilt objects</a></li>
<li class="chapter" data-level="4.5" data-path="the-very-basics.html"><a href="the-very-basics.html#variable-names"><i class="fa fa-check"></i><b>4.5</b> Variable names</a></li>
<li class="chapter" data-level="4.6" data-path="the-very-basics.html"><a href="the-very-basics.html#saving-your-workspace"><i class="fa fa-check"></i><b>4.6</b> Saving your workspace</a></li>
<li class="chapter" data-level="4.7" data-path="the-very-basics.html"><a href="the-very-basics.html#scripts-1"><i class="fa fa-check"></i><b>4.7</b> Scripts</a></li>
<li class="chapter" data-level="4.8" data-path="the-very-basics.html"><a href="the-very-basics.html#comments"><i class="fa fa-check"></i><b>4.8</b> Comments</a></li>
<li class="chapter" data-level="" data-path="the-very-basics.html"><a href="the-very-basics.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>5</b> Data types</a><ul>
<li class="chapter" data-level="5.1" data-path="data-types.html"><a href="data-types.html#data-frames"><i class="fa fa-check"></i><b>5.1</b> Data frames</a></li>
<li class="chapter" data-level="5.2" data-path="data-types.html"><a href="data-types.html#examining-an-object"><i class="fa fa-check"></i><b>5.2</b> Examining an object</a></li>
<li class="chapter" data-level="5.3" data-path="data-types.html"><a href="data-types.html#the-accessor"><i class="fa fa-check"></i><b>5.3</b> The accessor</a></li>
<li class="chapter" data-level="5.4" data-path="data-types.html"><a href="data-types.html#vectors-numerics-characters-and-logical"><i class="fa fa-check"></i><b>5.4</b> Vectors: numerics, characters, and logical</a></li>
<li class="chapter" data-level="5.5" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>5.5</b> Factors</a></li>
<li class="chapter" data-level="5.6" data-path="data-types.html"><a href="data-types.html#lists"><i class="fa fa-check"></i><b>5.6</b> Lists</a></li>
<li class="chapter" data-level="" data-path="data-types.html"><a href="data-types.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>6</b> Vectors</a><ul>
<li class="chapter" data-level="6.1" data-path="vectors.html"><a href="vectors.html#creating-vectors"><i class="fa fa-check"></i><b>6.1</b> Creating vectors</a></li>
<li class="chapter" data-level="6.2" data-path="vectors.html"><a href="vectors.html#names"><i class="fa fa-check"></i><b>6.2</b> Names</a></li>
<li class="chapter" data-level="6.3" data-path="vectors.html"><a href="vectors.html#sequences"><i class="fa fa-check"></i><b>6.3</b> Sequences</a></li>
<li class="chapter" data-level="6.4" data-path="vectors.html"><a href="vectors.html#subsetting"><i class="fa fa-check"></i><b>6.4</b> Subsetting</a></li>
<li class="chapter" data-level="6.5" data-path="vectors.html"><a href="vectors.html#coercion"><i class="fa fa-check"></i><b>6.5</b> Coercion</a></li>
<li class="chapter" data-level="6.6" data-path="vectors.html"><a href="vectors.html#not-availables-na"><i class="fa fa-check"></i><b>6.6</b> Not Availables (NA)</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sorting.html"><a href="sorting.html"><i class="fa fa-check"></i><b>7</b> Sorting</a><ul>
<li class="chapter" data-level="7.1" data-path="sorting.html"><a href="sorting.html#sort"><i class="fa fa-check"></i><b>7.1</b> <code>sort</code></a></li>
<li class="chapter" data-level="7.2" data-path="sorting.html"><a href="sorting.html#order"><i class="fa fa-check"></i><b>7.2</b> <code>order</code></a></li>
<li class="chapter" data-level="7.3" data-path="sorting.html"><a href="sorting.html#max-and-which.max"><i class="fa fa-check"></i><b>7.3</b> <code>max</code> and <code>which.max</code></a></li>
<li class="chapter" data-level="7.4" data-path="sorting.html"><a href="sorting.html#rank"><i class="fa fa-check"></i><b>7.4</b> <code>rank</code></a></li>
<li class="chapter" data-level="7.5" data-path="sorting.html"><a href="sorting.html#beware-of-recycling"><i class="fa fa-check"></i><b>7.5</b> Beware of recycling</a></li>
<li class="chapter" data-level="" data-path="sorting.html"><a href="sorting.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vector-arithmetics.html"><a href="vector-arithmetics.html"><i class="fa fa-check"></i><b>8</b> Vector arithmetics</a><ul>
<li class="chapter" data-level="8.1" data-path="vector-arithmetics.html"><a href="vector-arithmetics.html#rescaling"><i class="fa fa-check"></i><b>8.1</b> Rescaling</a></li>
<li class="chapter" data-level="8.2" data-path="vector-arithmetics.html"><a href="vector-arithmetics.html#two-vectors"><i class="fa fa-check"></i><b>8.2</b> Two vectors</a></li>
<li class="chapter" data-level="" data-path="vector-arithmetics.html"><a href="vector-arithmetics.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="indexing.html"><a href="indexing.html"><i class="fa fa-check"></i><b>9</b> Indexing</a><ul>
<li class="chapter" data-level="9.1" data-path="indexing.html"><a href="indexing.html#subsetting-with-logicals"><i class="fa fa-check"></i><b>9.1</b> Subsetting with logicals</a></li>
<li class="chapter" data-level="9.2" data-path="indexing.html"><a href="indexing.html#logical-operators"><i class="fa fa-check"></i><b>9.2</b> Logical operators</a></li>
<li class="chapter" data-level="9.3" data-path="indexing.html"><a href="indexing.html#which"><i class="fa fa-check"></i><b>9.3</b> <code>which</code></a></li>
<li class="chapter" data-level="9.4" data-path="indexing.html"><a href="indexing.html#match"><i class="fa fa-check"></i><b>9.4</b> <code>match</code></a></li>
<li class="chapter" data-level="9.5" data-path="indexing.html"><a href="indexing.html#in"><i class="fa fa-check"></i><b>9.5</b> <code>%in%</code></a></li>
<li class="chapter" data-level="" data-path="indexing.html"><a href="indexing.html#exercises-4"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html"><i class="fa fa-check"></i><b>10</b> Basic Data Wrangling</a><ul>
<li class="chapter" data-level="10.1" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#adding-a-column-with-mutate"><i class="fa fa-check"></i><b>10.1</b> Adding a column with <code>mutate</code></a></li>
<li class="chapter" data-level="10.2" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#subsetting-with-filter"><i class="fa fa-check"></i><b>10.2</b> Subsetting with <code>filter</code></a></li>
<li class="chapter" data-level="10.3" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#selecting-columns-with-select"><i class="fa fa-check"></i><b>10.3</b> Selecting columns with <code>select</code></a></li>
<li class="chapter" data-level="10.4" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#the-pipe"><i class="fa fa-check"></i><b>10.4</b> The pipe: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="10.5" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#creating-a-data-frame"><i class="fa fa-check"></i><b>10.5</b> Creating a data frame</a></li>
<li class="chapter" data-level="" data-path="basic-data-wrangling.html"><a href="basic-data-wrangling.html#exercises-5"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="basic-plots.html"><a href="basic-plots.html"><i class="fa fa-check"></i><b>11</b> Basic plots</a><ul>
<li class="chapter" data-level="11.1" data-path="basic-plots.html"><a href="basic-plots.html#scatter-plots"><i class="fa fa-check"></i><b>11.1</b> Scatter plots</a></li>
<li class="chapter" data-level="11.2" data-path="basic-plots.html"><a href="basic-plots.html#histograms"><i class="fa fa-check"></i><b>11.2</b> Histograms</a></li>
<li class="chapter" data-level="11.3" data-path="basic-plots.html"><a href="basic-plots.html#boxplot"><i class="fa fa-check"></i><b>11.3</b> Boxplot</a></li>
<li class="chapter" data-level="" data-path="basic-plots.html"><a href="basic-plots.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>12</b> Importing Data</a><ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#paths-and-the-working-directory"><i class="fa fa-check"></i>Paths and the working directory</a></li>
<li class="chapter" data-level="12.1" data-path="importing-data.html"><a href="importing-data.html#read.csv"><i class="fa fa-check"></i><b>12.1</b> <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="programming-basics.html"><a href="programming-basics.html"><i class="fa fa-check"></i><b>13</b> Programming basics</a><ul>
<li class="chapter" data-level="13.1" data-path="programming-basics.html"><a href="programming-basics.html#conditionals-expressions"><i class="fa fa-check"></i><b>13.1</b> Conditionals expressions</a></li>
<li class="chapter" data-level="13.2" data-path="programming-basics.html"><a href="programming-basics.html#defining-functions"><i class="fa fa-check"></i><b>13.2</b> Defining functions</a></li>
<li class="chapter" data-level="13.3" data-path="programming-basics.html"><a href="programming-basics.html#for-loops"><i class="fa fa-check"></i><b>13.3</b> For-loops</a></li>
<li class="chapter" data-level="13.4" data-path="programming-basics.html"><a href="programming-basics.html#vectorization-and-functionals"><i class="fa fa-check"></i><b>13.4</b> Vectorization and Functionals</a></li>
<li class="chapter" data-level="13.5" data-path="programming-basics.html"><a href="programming-basics.html#map"><i class="fa fa-check"></i><b>13.5</b> map</a></li>
<li class="chapter" data-level="13.6" data-path="programming-basics.html"><a href="programming-basics.html#other-functions"><i class="fa fa-check"></i><b>13.6</b> Other functions</a></li>
<li class="chapter" data-level="" data-path="programming-basics.html"><a href="programming-basics.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="matrices.html"><a href="matrices.html"><i class="fa fa-check"></i><b>14</b> Matrices</a><ul>
<li class="chapter" data-level="14.1" data-path="matrices.html"><a href="matrices.html#accessing-matrix-values"><i class="fa fa-check"></i><b>14.1</b> Accessing matrix values</a></li>
</ul></li>
<li class="part"><span><b>II Data Visualization</b></span></li>
<li class="chapter" data-level="15" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>15</b> Introduction</a></li>
<li class="chapter" data-level="16" data-path="data-types-1.html"><a href="data-types-1.html"><i class="fa fa-check"></i><b>16</b> Data types</a><ul>
<li class="chapter" data-level="" data-path="data-types-1.html"><a href="data-types-1.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>17</b> Distributions</a><ul>
<li class="chapter" data-level="17.1" data-path="distributions.html"><a href="distributions.html#case-study-student-heights"><i class="fa fa-check"></i><b>17.1</b> Case study: student heights</a></li>
<li class="chapter" data-level="17.2" data-path="distributions.html"><a href="distributions.html#distribution-function"><i class="fa fa-check"></i><b>17.2</b> Distribution function</a></li>
<li class="chapter" data-level="17.3" data-path="distributions.html"><a href="distributions.html#cumulative-distribution-functions"><i class="fa fa-check"></i><b>17.3</b> Cumulative distribution functions</a></li>
<li class="chapter" data-level="17.4" data-path="distributions.html"><a href="distributions.html#histograms-1"><i class="fa fa-check"></i><b>17.4</b> Histograms</a></li>
<li class="chapter" data-level="17.5" data-path="distributions.html"><a href="distributions.html#smoothed-density"><i class="fa fa-check"></i><b>17.5</b> Smoothed density</a><ul>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#interpreting-the-y-axis"><i class="fa fa-check"></i>Interpreting the y-axis</a></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#densities-permit-stratification"><i class="fa fa-check"></i>Densities permit stratification</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-8"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="17.6" data-path="distributions.html"><a href="distributions.html#the-normal-distribution"><i class="fa fa-check"></i><b>17.6</b> The normal distribution</a><ul>
<li class="chapter" data-level="17.6.1" data-path="distributions.html"><a href="distributions.html#standardized-units"><i class="fa fa-check"></i><b>17.6.1</b> Standardized units</a></li>
<li class="chapter" data-level="17.6.2" data-path="distributions.html"><a href="distributions.html#quantile-quantile-qq-plots"><i class="fa fa-check"></i><b>17.6.2</b> Quantile-quantile QQ plots</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="distributions.html"><a href="distributions.html#percentiles"><i class="fa fa-check"></i><b>17.7</b> Percentiles</a></li>
<li class="chapter" data-level="17.8" data-path="distributions.html"><a href="distributions.html#case-study-coninued-summarizing-male-heights-with-two-numbers"><i class="fa fa-check"></i><b>17.8</b> Case study coninued: summarizing male heights with two numbers</a></li>
<li class="chapter" data-level="" data-path="distributions.html"><a href="distributions.html#exercises-9"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="17.9" data-path="distributions.html"><a href="distributions.html#boxplots"><i class="fa fa-check"></i><b>17.9</b> Boxplots</a></li>
<li class="chapter" data-level="17.10" data-path="distributions.html"><a href="distributions.html#case-study-continued-female-student-heights"><i class="fa fa-check"></i><b>17.10</b> Case study continued: female student heights</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="robust-summaries.html"><a href="robust-summaries.html"><i class="fa fa-check"></i><b>18</b> Robust summaries</a><ul>
<li class="chapter" data-level="18.1" data-path="robust-summaries.html"><a href="robust-summaries.html#outliers"><i class="fa fa-check"></i><b>18.1</b> Outliers</a></li>
<li class="chapter" data-level="18.2" data-path="robust-summaries.html"><a href="robust-summaries.html#median"><i class="fa fa-check"></i><b>18.2</b> Median</a></li>
<li class="chapter" data-level="18.3" data-path="robust-summaries.html"><a href="robust-summaries.html#the-inter-quartile-range-iqr"><i class="fa fa-check"></i><b>18.3</b> The inter quartile range (IQR)</a></li>
<li class="chapter" data-level="18.4" data-path="robust-summaries.html"><a href="robust-summaries.html#tukeys-definition-of-an-outlier"><i class="fa fa-check"></i><b>18.4</b> Tukey’s definition of an outlier</a></li>
<li class="chapter" data-level="18.5" data-path="robust-summaries.html"><a href="robust-summaries.html#median-absolute-deviation"><i class="fa fa-check"></i><b>18.5</b> Median absolute deviation</a></li>
<li class="chapter" data-level="" data-path="robust-summaries.html"><a href="robust-summaries.html#exercises-10"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="18.6" data-path="robust-summaries.html"><a href="robust-summaries.html#case-study-self-reported-heights"><i class="fa fa-check"></i><b>18.6</b> Case Study: self-reported heights</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html"><i class="fa fa-check"></i><b>19</b> Summarizing data with dplyr</a><ul>
<li class="chapter" data-level="19.1" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#summarize"><i class="fa fa-check"></i><b>19.1</b> Summarize</a></li>
<li class="chapter" data-level="19.2" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#the-dot-operator"><i class="fa fa-check"></i><b>19.2</b> The dot operator</a></li>
<li class="chapter" data-level="19.3" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#group-then-summarize"><i class="fa fa-check"></i><b>19.3</b> Group then summarize</a></li>
<li class="chapter" data-level="19.4" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#sorting-data-tables"><i class="fa fa-check"></i><b>19.4</b> Sorting data tables</a><ul>
<li class="chapter" data-level="" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#nested-sorting"><i class="fa fa-check"></i>Nested sorting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summarizing-data-with-dplyr.html"><a href="summarizing-data-with-dplyr.html#exercises-11"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>20</b> ggplot2</a><ul>
<li class="chapter" data-level="20.1" data-path="ggplot2.html"><a href="ggplot2.html#the-cheat-sheet"><i class="fa fa-check"></i><b>20.1</b> The cheat sheet</a></li>
<li class="chapter" data-level="20.2" data-path="ggplot2.html"><a href="ggplot2.html#the-components-of-a-graph"><i class="fa fa-check"></i><b>20.2</b> The components of a graph</a></li>
<li class="chapter" data-level="20.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot-objects-a-blank-slate"><i class="fa fa-check"></i><b>20.3</b> <code>ggplot</code> objects: a blank slate</a></li>
<li class="chapter" data-level="20.4" data-path="ggplot2.html"><a href="ggplot2.html#geometries"><i class="fa fa-check"></i><b>20.4</b> Geometries</a></li>
<li class="chapter" data-level="20.5" data-path="ggplot2.html"><a href="ggplot2.html#aesthetic-mappings"><i class="fa fa-check"></i><b>20.5</b> Aesthetic mappings</a></li>
<li class="chapter" data-level="20.6" data-path="ggplot2.html"><a href="ggplot2.html#layers"><i class="fa fa-check"></i><b>20.6</b> Layers</a></li>
<li class="chapter" data-level="20.7" data-path="ggplot2.html"><a href="ggplot2.html#tinkering-with-arguments"><i class="fa fa-check"></i><b>20.7</b> Tinkering with arguments</a></li>
<li class="chapter" data-level="20.8" data-path="ggplot2.html"><a href="ggplot2.html#global-versus-local-aesthetic-mappings"><i class="fa fa-check"></i><b>20.8</b> Global versus local aesthetic mappings</a></li>
<li class="chapter" data-level="20.9" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>20.9</b> Scales</a></li>
<li class="chapter" data-level="20.10" data-path="ggplot2.html"><a href="ggplot2.html#labels-and-titles"><i class="fa fa-check"></i><b>20.10</b> Labels and titles</a></li>
<li class="chapter" data-level="20.11" data-path="ggplot2.html"><a href="ggplot2.html#categories-as-colors"><i class="fa fa-check"></i><b>20.11</b> Categories as colors</a></li>
<li class="chapter" data-level="20.12" data-path="ggplot2.html"><a href="ggplot2.html#annotation-and-shapes"><i class="fa fa-check"></i><b>20.12</b> Annotation and shapes</a></li>
<li class="chapter" data-level="20.13" data-path="ggplot2.html"><a href="ggplot2.html#adjustments"><i class="fa fa-check"></i><b>20.13</b> Adjustments</a></li>
<li class="chapter" data-level="20.14" data-path="ggplot2.html"><a href="ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>20.14</b> Add-on packages</a></li>
<li class="chapter" data-level="20.15" data-path="ggplot2.html"><a href="ggplot2.html#putting-it-all-together"><i class="fa fa-check"></i><b>20.15</b> Putting it all together</a></li>
<li class="chapter" data-level="20.16" data-path="ggplot2.html"><a href="ggplot2.html#other-geometries"><i class="fa fa-check"></i><b>20.16</b> Other geometries</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#histogram"><i class="fa fa-check"></i>Histogram</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#density"><i class="fa fa-check"></i>Density</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#qq-plots"><i class="fa fa-check"></i>QQ-plots</a></li>
</ul></li>
<li class="chapter" data-level="20.17" data-path="ggplot2.html"><a href="ggplot2.html#grids-of-plots"><i class="fa fa-check"></i><b>20.17</b> Grids of plots</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html"><i class="fa fa-check"></i><b>21</b> Case study: trends in world health and economics</a><ul>
<li class="chapter" data-level="21.1" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#example-1-life-expectancy-and-fertility-rates"><i class="fa fa-check"></i><b>21.1</b> Example 1: Life expectancy and fertility rates</a><ul>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#hans-roslings-quiz"><i class="fa fa-check"></i>Hans Rosling’s quiz</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#a-scatterplot"><i class="fa fa-check"></i>A scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#faceting"><i class="fa fa-check"></i><b>21.2</b> Faceting</a><ul>
<li><a href="case-study-trends-in-world-health-and-economics.html#facet_wrap"><code>facet_wrap</code></a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#fixed-scales-for-better-comparisons"><i class="fa fa-check"></i><b>21.3</b> Fixed scales for better comparisons</a></li>
<li class="chapter" data-level="21.4" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#time-series-plots"><i class="fa fa-check"></i><b>21.4</b> Time series plots</a></li>
<li class="chapter" data-level="21.5" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#labels-for-legends"><i class="fa fa-check"></i><b>21.5</b> Labels for legends</a></li>
<li class="chapter" data-level="21.6" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#example-2-income-distribution"><i class="fa fa-check"></i><b>21.6</b> Example 2: Income distribution</a></li>
<li class="chapter" data-level="21.7" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#transformations"><i class="fa fa-check"></i><b>21.7</b> Transformations</a><ul>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#country-income-distribution"><i class="fa fa-check"></i>Country income distribution</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#which-base"><i class="fa fa-check"></i>Which base?</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#transform-the-values-or-the-scale"><i class="fa fa-check"></i>Transform the values or the scale?</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#modes"><i class="fa fa-check"></i>Modes</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#stratify-and-boxplot"><i class="fa fa-check"></i><b>21.8</b> Stratify and boxplot</a><ul>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#do-not-order-alphabetically"><i class="fa fa-check"></i>Do not order alphabetically</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#show-the-data"><i class="fa fa-check"></i>Show the data</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#comparing-distributions"><i class="fa fa-check"></i><b>21.9</b> Comparing distributions</a><ul>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#density-plots"><i class="fa fa-check"></i>Density plots</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#accessing-computed-variables"><i class="fa fa-check"></i>Accessing computed variables</a></li>
<li class="chapter" data-level="21.9.1" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#case_when"><i class="fa fa-check"></i><b>21.9.1</b> ‘case_when’</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#weighted-densities"><i class="fa fa-check"></i>Weighted densities</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#ecological-fallacy"><i class="fa fa-check"></i><b>21.10</b> Ecological fallacy</a><ul>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#logistic-transformation"><i class="fa fa-check"></i>Logistic transformation</a></li>
<li class="chapter" data-level="" data-path="case-study-trends-in-world-health-and-economics.html"><a href="case-study-trends-in-world-health-and-economics.html#show-the-data-1"><i class="fa fa-check"></i>Show the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html"><i class="fa fa-check"></i><b>22</b> Data visualization principles</a><ul>
<li class="chapter" data-level="22.1" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#encoding-data-using-visual-cues"><i class="fa fa-check"></i><b>22.1</b> Encoding data using visual cues</a></li>
<li class="chapter" data-level="22.2" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#know-when-to-include-0"><i class="fa fa-check"></i><b>22.2</b> Know when to include 0</a></li>
<li class="chapter" data-level="22.3" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#do-not-distort-quantities"><i class="fa fa-check"></i><b>22.3</b> Do not distort quantities</a></li>
<li class="chapter" data-level="22.4" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#order-by-a-meaningful-value"><i class="fa fa-check"></i><b>22.4</b> Order by a meaningful value</a></li>
<li class="chapter" data-level="22.5" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#show-the-data-2"><i class="fa fa-check"></i><b>22.5</b> Show the data</a></li>
<li class="chapter" data-level="22.6" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#ease-comparisons-use-common-axes"><i class="fa fa-check"></i><b>22.6</b> Ease comparisons: use common axes</a></li>
<li class="chapter" data-level="22.7" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#ease-comparisons-align-plots-vertically-to-see-horizontal-changes-and-horizontally-to-see-vertical-changes"><i class="fa fa-check"></i><b>22.7</b> Ease comparisons: align plots vertically to see horizontal changes and horizontally to see vertical changes</a></li>
<li class="chapter" data-level="22.8" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#consider-transformations"><i class="fa fa-check"></i><b>22.8</b> Consider transformations</a></li>
<li class="chapter" data-level="22.9" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#ease-comparisons-visual-cues-to-be-compared-should-be-adjacent."><i class="fa fa-check"></i><b>22.9</b> Ease comparisons: Visual cues to be compared should be adjacent.</a></li>
<li class="chapter" data-level="22.10" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#ease-comparison-use-color"><i class="fa fa-check"></i><b>22.10</b> Ease comparison: use color</a></li>
<li class="chapter" data-level="22.11" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#think-of-the-color-blind"><i class="fa fa-check"></i><b>22.11</b> Think of the color blind</a></li>
<li class="chapter" data-level="22.12" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#use-scatter-plots-to-examine-the-relationship-between-two-variables"><i class="fa fa-check"></i><b>22.12</b> Use scatter plots to examine the relationship between two variables</a><ul>
<li class="chapter" data-level="22.12.1" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#slope-charts"><i class="fa fa-check"></i><b>22.12.1</b> Slope charts</a></li>
<li class="chapter" data-level="22.12.2" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#bland-altman-plot"><i class="fa fa-check"></i><b>22.12.2</b> Bland-Altman plot</a></li>
</ul></li>
<li class="chapter" data-level="22.13" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#encoding-a-third-variable"><i class="fa fa-check"></i><b>22.13</b> Encoding a third variable</a></li>
<li class="chapter" data-level="22.14" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#avoid-pseudo-three-dimensional-plots"><i class="fa fa-check"></i><b>22.14</b> Avoid pseudo three dimensional plots</a></li>
<li class="chapter" data-level="22.15" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#avoid-gratuitous-three-dimensional-plots"><i class="fa fa-check"></i><b>22.15</b> Avoid gratuitous three dimensional plots</a></li>
<li class="chapter" data-level="22.16" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#avoid-too-many-significant-digits"><i class="fa fa-check"></i><b>22.16</b> Avoid too many significant digits</a></li>
<li class="chapter" data-level="22.17" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#further-reading"><i class="fa fa-check"></i><b>22.17</b> Further reading:</a></li>
<li class="chapter" data-level="" data-path="data-visualization-principles.html"><a href="data-visualization-principles.html#exercises-12"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="case-study-the-impact-of-vaccines-on-battling-infectious-diseases.html"><a href="case-study-the-impact-of-vaccines-on-battling-infectious-diseases.html"><i class="fa fa-check"></i><b>23</b> Case study: the impact of vaccines on battling infectious diseases</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-study-the-impact-of-vaccines-on-battling-infectious-diseases" class="section level1">
<h1><span class="header-section-number">Chapter 23</span> Case study: the impact of vaccines on battling infectious diseases</h1>
<p>Vaccines have helped save millions of lives. In the 19th century, before herd immunization was achieved through vaccination programs, deaths from infectious diseases, such as smallpox and polio, were common. However, today, despite all the scientific evidence for their importance, vaccination programs have become somewhat controversial.</p>
<p>The controversy started with a <a href="http://www.thelancet.com/journals/lancet/article/PIIS0140-6736(97)11096-0/abstract">paper</a> published in 1988 and lead by <a href="https://en.wikipedia.org/wiki/Andrew_Wakefield">Andrew Wakefield</a> claiming there was a link between the administration of the measles, mumps and rubella (MMR) vaccine, and the appearance of autism and bowel disease. Despite much scientific evidence contradicting this finding, sensationalist media reports and fear mongering from conspiracy theorists led parts of the public into believing that vaccines were harmful. As a result, many parents ceased to vaccinate their children. This dangerous practice can be potentially disastrous given that the Center for Disease Control (CDC) estimates that vaccinations will prevent more than 21 million hospitalizations and 732,000 deaths among children born in the last 20 years (see <a href="https://www.cdc.gov/mmwr/preview/mmwrhtml/mm6316a4.htm">Benefits from Immunization during the Vaccines for Children Program Era — United States, 1994-2013, MMWR</a>). The 1988 paper has since been <a href="http://www.thelancet.com/journals/lancet/article/PIIS0140-6736(97)11096-0/abstract">retracted</a> and Andrew Wakefield was eventually “struck off the UK medical register, with a statement identifying deliberate falsification in the research published in The Lancet, and was thereby barred from practicing medicine in the UK.” (<a href="https://en.wikipedia.org/wiki/Andrew_Wakefield">source: Wikipedia</a>). Yet misconceptions persist, in part due to self-proclaimed activists who continue to disseminate misinformation about vaccines.</p>
<p>Effective communication of data is a strong antidote to misinformation and fear mongering. Earlier we showed an example provided by a <a href="http://graphics.wsj.com/infectious-diseases-and-vaccines/">Wall Street Journal article</a> showing data related to the impact of vaccines on battling infectious diseases. Here we reconstruct that example.</p>
<p>The data used for these plots were collected, organized and distributed by the <a href="http://www.tycho.pitt.edu/">Tycho Project</a>. They include weekly reported counts data for seven diseases from 1928 to 2011, from all fifty states. We include the yearly totals in the <code>dslabs</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(us_contagious_diseases)
<span class="kw">str</span>(us_contagious_diseases)
<span class="co">#&gt; &#39;data.frame&#39;:    18870 obs. of  6 variables:</span>
<span class="co">#&gt;  $ disease        : Factor w/ 7 levels &quot;Hepatitis A&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ state          : Factor w/ 51 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ year           : num  1966 1967 1968 1969 1970 ...</span>
<span class="co">#&gt;  $ weeks_reporting: int  50 49 52 49 51 51 45 45 45 46 ...</span>
<span class="co">#&gt;  $ count          : num  321 291 314 380 413 378 342 467 244 286 ...</span>
<span class="co">#&gt;  $ population     : num  3345787 3364130 3386068 3412450 3444165 ...</span></code></pre></div>
<p>We create a temporary object <code>dat</code> that stores only the measles data, includes a per 100,000 rate, orders states by average value of disease and removes Alaska and Hawaii since they only became states in the late 50s. Note that there is a <code>weeks_reporting</code> column that tells us how many weeks reported cases. So we have to adjust for that when computing the rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">the_disease &lt;-<span class="st"> &quot;Measles&quot;</span>
dat &lt;-<span class="st"> </span>us_contagious_diseases <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>state<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;Hawaii&quot;</span>,<span class="st">&quot;Alaska&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>disease <span class="op">==</span><span class="st"> </span>the_disease) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> count <span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">10000</span> <span class="op">*</span><span class="st"> </span><span class="dv">52</span> <span class="op">/</span><span class="st"> </span>weeks_reporting) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">state =</span> <span class="kw">reorder</span>(state, rate)) </code></pre></div>
<p>We can now easily plot disease rates per year. Here are the measles data from California:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;California&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(rate)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, rate)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Cases per 10,000&quot;</span>)  <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">1963</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="book_files/figure-html/california-measles-time-series-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We add a vertical line at 1963 since this is when the vaccine was introduced [Control, Centers for Disease; Prevention (2014). CDC health information for international travel 2014 the yellow book. p. 250. ISBN 9780199948505].</p>
<p>Now, can we show data for all states in one plot? We have three variables to show: year, state and rate. In the WSJ figure, they use the x-axis for year, the y-axis for state and color hue to represent rates. However, the color scale they use, which goes from yellow to blue to green to orange to red can be improved.</p>
<p>In our example we want to use a sequential palette since there is no meaningful center, just low and high rates.</p>
<p>We use the geometry <code>geom_tile</code> to tile the region with colors representing disease rates. We use a square root transformation to avoid having the really high counts dominate the plot. Notice that missing values are shown in grey. Once the disease was pretty much erradicated some states stopped reporting cases all together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, state,  <span class="dt">fill =</span> rate)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> <span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Reds&quot;</span>), <span class="dt">trans =</span> <span class="st">&quot;sqrt&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">1963</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(the_disease) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="book_files/figure-html/vaccines-plot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This plot makes a very striking argument for the contribution of vaccines. However, one limitation of this plot is that it uses color to represent quantity which we earlier explained makes it harder to know exactly how high it is going. Position and lengths are better cues. If we are willing to lose state information, we can make a version of the plot that shows the values with position. We can also show the average for the US which we compute like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avg &lt;-<span class="st"> </span>us_contagious_diseases <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(disease<span class="op">==</span>the_disease) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">us_rate =</span> <span class="kw">sum</span>(count, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">/</span><span class="kw">sum</span>(population, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">*</span><span class="dv">10000</span>)</code></pre></div>
<p>Now to make the plot we simply use the <code>geom_line</code> geometry:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(year, rate, <span class="dt">group =</span> state),  <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, 
            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(year, us_rate),  <span class="dt">data =</span> avg, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;sqrt&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">125</span>,<span class="dv">300</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cases per 10,000 by state&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="dv">1955</span>, <span class="dt">y=</span><span class="dv">50</span>), <span class="dt">mapping =</span> <span class="kw">aes</span>(x, y, <span class="dt">label=</span><span class="st">&quot;US average&quot;</span>), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">1963</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) 
<span class="co">#&gt; Warning: Removed 180 rows containing missing values (geom_path).</span></code></pre></div>
<p><img src="book_files/figure-html/time-series-vaccines-plot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In theory we could use color to represent the categorical value state, but it is hard to pick 50 distinct colors.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-principles.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rafalab/dsbook/edit/master/dataviz/dataviz-principles.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
